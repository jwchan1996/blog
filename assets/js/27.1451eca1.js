(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{410:function(s,n,a){s.exports=a.p+"assets/img/01.e586df11.png"},495:function(s,n,a){"use strict";a.r(n);var e=a(43),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,e=s._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"加载-commonjs-模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#加载-commonjs-模块"}},[s._v("#")]),s._v(" 加载 CommonJS 模块")]),s._v(" "),e("p",[e("code",[s._v("rollup")]),s._v(" 提供的 "),e("code",[s._v("rollup-plugin-commonjs")]),s._v(" 可以使得 "),e("code",[s._v("rollup")]),s._v(" 支持处理 "),e("code",[s._v("CommonJS")]),s._v(" 的模块。")]),s._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/jwchan1996/rollup-play/blob/main/05-commonjs",target:"_blank",rel:"noopener noreferrer"}},[s._v("示例代码仓库"),e("OutboundLink")],1)]),s._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" rollup-plugin-commonjs --dev\n")])])]),e("div",{staticClass:"language-diff extra-class"},[e("pre",{pre:!0,attrs:{class:"language-diff"}},[e("code",[e("span",{pre:!0,attrs:{class:"token unchanged"}},[s._v("  // rollup.config.js\n")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token unchanged"}},[s._v("  import json from 'rollup-plugin-json'\n  import resolve from 'rollup-plugin-node-resolve'\n")]),e("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[s._v("+ import commonjs from 'rollup-plugin-commonjs'\n")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token unchanged"}},[s._v("  export default {\n    input: 'src/index.js',\n    output: {\n      file: 'dist/bundle.js',\n      format: 'iife'\n    },\n    plugins: [\n      json(),\n      resolve(),\n")]),e("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[s._v("+     commonjs()\n")]),e("span",{pre:!0,attrs:{class:"token unchanged"}},[s._v("    ]\n  }\n")])])])]),e("p",[s._v("新建一个 "),e("code",[s._v("CommonJS")]),s._v(" 模块文件，然后对这个文件的导出进行引入：")]),s._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// src/cjs-module.js")]),s._v("\n\nmodule"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  foo"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'bar'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),e("div",{staticClass:"language-diff extra-class"},[e("pre",{pre:!0,attrs:{class:"language-diff"}},[e("code",[e("span",{pre:!0,attrs:{class:"token unchanged"}},[s._v("  // src/index.js\n")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token unchanged"}},[s._v("  // 导入模块成员\n  import _ from 'lodash-es'\n  import { log } from './logger'\n  import messages from './messages'\n  import { name, version } from '../package.json'\n")]),e("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[s._v("+ import cjs from './cjs-module'\n")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token unchanged"}},[s._v("  // 使用模块成员\n  const msg = messages.hi\n")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token unchanged"}},[s._v("  log(msg)\n")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token unchanged"}},[s._v("  log(name)\n  log(version)\n  log(_.camelCase('hello world'))\n")]),e("span",{pre:!0,attrs:{class:"token inserted-sign inserted"}},[s._v("+ log(cjs)\n")])])])]),e("p",[s._v("打包后，可以看到 "),e("code",[s._v("CommonJS")]),s._v(" 模块的导出会以一个对象的形式出现在打包后的代码中。")]),s._v(" "),e("p",[e("img",{attrs:{src:a(410),alt:"01"}})])])}),[],!1,null,null,null);n.default=t.exports}}]);